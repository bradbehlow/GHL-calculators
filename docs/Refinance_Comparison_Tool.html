<!DOCTYPE html>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
 <script src="auth.js"></script>
<style>
#hm2_cl *, ::after, ::before {
    box-sizing: border-box;
}
#hm2_cl {
    line-height: 1.5;
    font-family: 'Roboto', sans-serif;
}
#hm2_cl .container {
    width: 100%;
    padding-right: 15px;
    padding-left: 15px;
    margin-right: auto;
    margin-left: auto;
    font-size: 1rem;
    font-weight: 400;
    line-height: 1.5;
    color: #080337;
    text-align: left;
}
#hm2_cl label {
    display: block;
    margin-bottom: .5rem;
    font-size: 14px;
    font-weight: 500;
}
#hm2_cl .table {
    width: 100%;
    max-width: 100%;
    margin-bottom: 0rem;
    background-color: transparent;
    border-collapse: collapse;
}
#hm2_cl .sp-table {
    width: 100%;
    max-width: 100%;
    margin-bottom: 0rem;
    background-color: transparent;
    border-collapse: collapse;
}
#hm2_cl .table td, #hm2_cl .table th {
    padding: 0 3px;
    vertical-align: middle;
    border-right: none !important;
    border-left: none !important;
    border-top: none !important;
    font-size: 16px;
    background: transparent;
    box-shadow: none;
    color:#000000;
}
#hm2_cl .sp-table td{
    padding: .65rem .75rem;
    vertical-align: middle;
    border-right: none !important;
    border-left: none !important;
    border-top: none !important;
    border-bottom: none;
    font-size: 16px;
    background: transparent;
    box-shadow: none;
    color:#000000;
}
#hm2_cl .sp-table th{
    padding: .65rem .75rem;
    vertical-align: middle;
    border-right: none !important;
    border-left: none !important;
    border-top: none !important;
    border-bottom: 1px solid #6BC14B;
    font-size: 16px;
    background: transparent;
    box-shadow: none;
    color:#000000;
}

#hm2_cl .table th {
    text-align: left;
    font-weight: 500;
    border-bottom: 1px solid #6BC14B;
}
#hm2_cl h3, h4, p {
    margin: 10px 0;
}
#hm2_cl .row {
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap;
    margin-right: -15px;
    margin-left: -15px;
}
#hm2_cl .col-md-1, #hm2_cl .col-md-10, #hm2_cl .col-md-11, #hm2_cl .col-md-12, #hm2_cl .col-md-2, #hm2_cl .col-md-3, #hm2_cl .col-md-4, #hm2_cl .col-md-5, #hm2_cl .col-md-6, #hm2_cl .col-md-7, #hm2_cl .col-md-8, #hm2_cl .col-md-9 {
    position: relative;
    width: 100%;
    padding-right: 15px;
    padding-left: 15px;
}
#hm2_cl .form-group {
    margin-bottom: 1rem;
}
#hm2_cl .form-control {
    display: block;
    width: 100%;
    height: 40px;
    padding: .375rem .75rem;
    font-size: 16px;
    font-weight: 400;
    line-height: 1.5;
    color: #080337;
    background-color: #fff;
    background-clip: padding-box;
    border: 1px solid #ced4da;
    border-radius: .25rem;
    transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;
}
#hm2_cl .tb-form-control {
    display: block;
    width: 100%;
    height: 40px;
    padding: .375rem .75rem;
    font-size: 16px;
    font-weight: 400;
    line-height: 1.5;
    color: #080337;
    background-color: #fff;
    background-clip: padding-box;
    border: none;
    border-bottom: 1px solid #D9D9D9;
    transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out;
}
#hm2_cl select.tb-form-control {
    visibility: visible !important;
    -webkit-appearance: auto !important;
}
#hm2_cl .form-control:focus {
    outline: none;
}
#hm2_cl .tb-form-control:focus {
    outline: none;
}
#hm2_cl .input-group {
    position: relative;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-wrap: wrap;
    flex-wrap: wrap;
    -ms-flex-align: stretch;
    align-items: stretch;
    width: 100%;
    margin-bottom: 1rem;
}
#hm2_cl .input-group>.custom-select:not(:last-child), #hm2_cl .input-group>.form-control:not(:last-child) {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}
#hm2_cl .input-group>.custom-file, #hm2_cl .input-group>.custom-select, #hm2_cl .input-group>.form-control, #hm2_cl .input-group>.form-control-plaintext {
    position: relative;
    -ms-flex: 1 1 0%;
    flex: 1 1 0%;
    min-width: 0;
    margin-bottom: 0;
}#hm2_cl .input-group>.custom-select:not(:first-child), #hm2_cl .input-group>.form-control:not(:first-child) {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}
#hm2_cl .input-group>.custom-select:not(:last-child), #hm2_cl .input-group>.form-control:not(:last-child) {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}
#hm2_cl .input-group>.custom-file+.custom-file, #hm2_cl .input-group>.custom-file+.custom-select, #hm2_cl .input-group>.custom-file+.form-control, #hm2_cl .input-group>.custom-select+.custom-file, #hm2_cl .input-group>.custom-select+.custom-select, #hm2_cl .input-group>.custom-select+.form-control, #hm2_cl .input-group>.form-control+.custom-file, #hm2_cl .input-group>.form-control+.custom-select, #hm2_cl .input-group>.form-control+.form-control, #hm2_cl .input-group>.form-control-plaintext+.custom-file, #hm2_cl .input-group>.form-control-plaintext+.custom-select, #hm2_cl .input-group>.form-control-plaintext+.form-control {
    margin-left: -1px;
}
#hm2_cl .input-group>.custom-file, #hm2_cl .input-group>.custom-select, #hm2_cl .input-group>.form-control, #hm2_cl .input-group>.form-control-plaintext {
    position: relative;
    -ms-flex: 1 1 0%;
    flex: 1 1 0%;
    min-width: 0;
    margin-bottom: 0;
}
#hm2_cl .custom-control-label::before, #hm2_cl .custom-file-label, #hm2_cl .custom-select {
    transition: background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;
}
#hm2_cl .input-group-append {
    margin-left: -1px;
}
#hm2_cl .input-group-append, #hm2_cl .input-group-prepend {
    display: -ms-flexbox;
    display: flex;
}
#hm2_cl .input-group>.input-group-append:last-child>.btn:not(:last-child):not(.dropdown-toggle), #hm2_cl .input-group>.input-group-append:last-child>.input-group-text:not(:last-child), #hm2_cl .input-group>.input-group-append:not(:last-child)>.btn, #hm2_cl .input-group>.input-group-append:not(:last-child)>.input-group-text, #hm2_cl .input-group>.input-group-prepend>.btn, #hm2_cl .input-group>.input-group-prepend>.input-group-text {
    border-top-right-radius: 0;
    border-bottom-right-radius: 0;
}
#hm2_cl .input-group>.input-group-append>.btn, #hm2_cl .input-group>.input-group-append>.input-group-text, #hm2_cl .input-group>.input-group-prepend:first-child>.btn:not(:first-child), #hm2_cl .input-group>.input-group-prepend:first-child>.input-group-text:not(:first-child), #hm2_cl .input-group>.input-group-prepend:not(:first-child)>.btn, #hm2_cl .input-group>.input-group-prepend:not(:first-child)>.input-group-text {
    border-top-left-radius: 0;
    border-bottom-left-radius: 0;
}
#hm2_cl .input-group-append .btn, #hm2_cl .input-group-prepend .btn {
    position: relative;
    z-index: 2;
}
#hm2_cl .input-group-text {
    display: -ms-flexbox;
    display: flex;
    -ms-flex-align: center;
    align-items: center;
    padding: 0.355rem 0.75rem;
    margin-bottom: 0;
    font-size: 1rem;
    font-weight: 400;
    line-height: 1.5;
    color: #080337;
    text-align: center;
    white-space: nowrap;
    background-color: #ffffff;
    border: 1px solid #ced4da;
    border-radius: 0.25rem;
}
#hm2_cl .input-group-append .btn+.btn, #hm2_cl .input-group-append .btn+.input-group-text, #hm2_cl .input-group-append .input-group-text+.btn, #hm2_cl .input-group-append .input-group-text+.input-group-text, #hm2_cl .input-group-prepend .btn+.btn, #hm2_cl .input-group-prepend .btn+.input-group-text, #hm2_cl .input-group-prepend .input-group-text+.btn, #hm2_cl .input-group-prepend .input-group-text+.input-group-text {
    margin-left: -1px;
}
#hm2_cl .input-group-prepend .btn, #hm2_cl .input-group-append .btn {
    position: relative;
    z-index: 2;
}
#hm2_cl .text-center {
    text-align: center!important;
}
/* Custom css */
#hm2_cl .cl-wrapper {
    position: relative;
    border-radius: 10px;
    background: #ffffff;
    box-shadow: 0 10px 30px 1px rgb(0 0 0 / 10%);
}
#hm2_cl .cl-left-div {
    padding: 3rem 3rem 2rem 3rem!important;
    background: #ffffff;
    border-radius: 10px;
}
#hm2_cl .cl-right-div {
    padding: 2rem 3rem !important;
    border-radius: 0 0 8px 8px;
    background: #ffffff;
    color: #080337;
}
#hm2_cl .rs-sec {
    display: flex;
    flex-direction: row;
    align-items: center;
    justify-content: space-around;
    border-radius: 10px;
    padding: 1rem 0.5rem;
    margin: 6px 0;
    box-shadow: 0 10px 30px 1px rgb(0 0 0 / 10%);
}
#hm2_cl .rs-vl {
    text-align: right;
    font-weight: 500;
}
#hm2_cl .rs-sub-title-sp {
    font-size: 16px;
    margin: 2px;
    border-bottom: 1px solid #6BC14B;
}
#hm2_cl .rs-sp-value {
    font-size: 22px;
    margin: 8px 2px;
    color: #6BC14B;
}
#hm2_cl .sp-rs {
    color: #6BC14B;
}
#hm2_cl .btn {
    display: inline-block;
    font-weight: 400;
    color: #212529;
    text-align: center;
    vertical-align: middle;
    cursor: pointer;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    background-color: transparent;
    border: 2px solid transparent;
    padding: 5px 60px;
    font-size: 18px;
    line-height: 32px;
    transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;
}
#hm2_cl .btn-primary {
    color: #fff;
    background-color: #6BC14B;
    border-color: #6BC14B;
    text-decoration: none;
    padding: 3px 60px;
    font-size: 18px;
}
#hm2_cl .btn-primary:hover {
    color: #fff;
    background-color: #6BC14B;
    border-color: #6BC14B;
}
/* responsive */

@media (max-width: 768px){
    #hm2_cl .cl-left-div {
        padding: 1rem 2rem !important;
    }
    #hm2_cl .cl-right-div {
        padding: 2rem 1rem !important;
        border-radius: 0 0 8px 8px;
    }
    #hm2_cl .form-control {
        height: auto;
        padding: .175rem .75rem;
    }
    #hm2_cl label {
        font-size: 14px;
    }
    #hm2_cl .rs-sec {
        flex-direction: column;
    }
    #hm2_cl .btn-warning {
        padding: 1.1375rem 2rem;
        font-size: 1rem;
    }
}
@media (min-width: 576px){
    #hm2_cl .container, #hm2_cl .container-sm {
        max-width: 540px;
    }
}
@media (min-width: 768px){
    #hm2_cl .container, #hm2_cl .container-md, #hm2_cl .container-sm {
        max-width: 100%;
    }
    #hm2_cl .col-md-12 {
        -ms-flex: 0 0 100%;
        flex: 0 0 100%;
        max-width: 100%;
    }
    #hm2_cl .col-md-9 {
        -ms-flex: 0 0 75%;
        flex: 0 0 75%;
        max-width: 75%;
    }
    #hm2_cl .col-md-8 {
        -ms-flex: 0 0 66.666667%;
        flex: 0 0 66.666667%;
        max-width: 66.666667%;
    }
    #hm2_cl .col-md-6 {
        -ms-flex: 0 0 50%;
        flex: 0 0 50%;
        max-width: 50%;
    }
    #hm2_cl .col-md-4 {
        -ms-flex: 0 0 33.333333%;
        flex: 0 0 33.333333%;
        max-width: 33.333333%;
    }
    #hm2_cl .col-md-3 {
        -ms-flex: 0 0 25%;
        flex: 0 0 25%;
        max-width: 25%;
    }
    #hm2_cl .col-md-2 {
        -ms-flex: 0 0 16.66667%;
        flex: 0 0 16.66667%;
        max-width: 16.66667%;
    }
}
@media (min-width: 992px){
    #hm2_cl .container, #hm2_cl .container-lg, #hm2_cl .container-md, #hm2_cl .container-sm {
        max-width: 900px;
    }
}
@media (min-width: 1200px) {
    #hm2_cl .container, #hm2_cl .container-lg, #hm2_cl .container-md, #hm2_cl .container-sm, #hm2_cl .container-xl {
        max-width: 900px;
    }
}
#hm2_cl hr {
    border: none;
    border-bottom: 1px solid #ccc;
}
#hm2_cl .optios-sec {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
}
#hm2_cl .radio-option {
    display: flex;
    flex-direction: row;
    align-items: center;
    background: #ffffff;
    padding: 6px 10px;
    width: 50%;
    border-radius: 5px;
    border: 1px solid #ccc;
    text-align: center;
    cursor: pointer;
    color: #080337;
    transition: all 0.2s;
    font-size: 16px;
    user-select: none;
}
#hm2_cl .radio-option:hover {
    background: #dddddd;
    border: 1px solid #dddddd;
}
#hm2_cl .radio-option.active {
    background: #34D9E5;
    border: 1px solid #34D9E5;
    color:#ffffff;
}
#hm2_cl .circle-radio {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: #ffffff;
    border: 1px solid #b5b5b5;
    margin-right: 6px;
}
#hm2_cl .mr-right {
    margin-right: 5px;
}
#hm2_cl .ds-none {
    display: none;
}
#hm2_cl .rs-sec-title {
    font-size: 22px;
    text-align: center;
    border-bottom: 1px solid #ccc;
    padding-bottom: 8px;
    color: #26459E;
}
#hm2_cl .grow-logo {
    width: 70px;
    display: inline-block;
}
#hm2_cl .text-center {
    text-align: center;
}
#hm2_cl .top-title {
    font-size: 26px;
    text-align: center;
    margin: 10px 0 30px 0;
    color: #6bc14b;
}
#hm2_cl .top-logo {
    width: 200px;
    margin-top: -32px;
}
#hm2_cl .sec-top-title {
   font-size: 18px;
   font-weight: 400;
   color: #000000;
   border-bottom: 1px solid #6BC14B;
}
#hm2_cl .all-debts-sec-title {
   font-size: 18px;
   font-weight: 400;
   color: #000000;
   border-bottom: 1px solid #6BC14B;
}
#hm2_cl .new-loan-sec-title {
   font-size: 18px;
   font-weight: 400;
   color: #000000;
   border-bottom: 1px solid #6BC14B;
}
#hm2_cl .sp-txt-cl {
    color: #26459E !important;
    font-weight: 600;
}
#hm2_cl .rs-saving-sec{
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    padding: 20px 20px;
    box-shadow: 0 10px 30px 1px rgb(0 0 0 / 10%);
    border-radius: 10px;
    margin: 0;
    margin-top: 15px;
    margin-bottom: 15px;
}
#hm2_cl .rs-saving-title{
    font-size: 20px;
    color: #26459E;
    font-weight: 600;
}
#hm2_cl .rs-saving-vl{
    font-size: 20px;
    color: #6BC14B;
    font-weight: 600;
    text-align: right;
}
#hm2_cl .debts-paid-sec-title {
   font-size: 18px;
   font-weight: 400;
   color: #000000;
   border-bottom: 1px solid #6BC14B;
}
#hm2_cl .middle-txt {
   font-size: 18px;
   font-weight: 400;
   color: #000000;
   text-align: center;
}
#hm2_cl .foorter-rs-sec {
   margin-bottom: 15px;
}
@media (max-width: 768px) {
    #hm2_cl .sp-table td {
        padding: 3px;
        font-size: 13px;
    }
}
/* PDF Section ===================================================================================================== */
/* PDF Section Styling - Matches Calculator Appearance */
#pdf_section {
    display: none; /* This keeps it hidden initially */
    position: absolute;
    left: -9999px; /* Moves it off-screen when not in use */
}

/* When generating PDF, we'll override these styles temporarily */
.html2pdf-container #pdf_section {
    font-family: Helvetica;
    font-weight: 500; /* Regular for body text */
    display: block !important;
    position: static !important;
    left: auto !important;
}
#pdf_data {
    font-family: Helvetica;
    font-weight: 550; /* Regular for body text */
    color: #080337;
    line-height: 1.6;
    padding: 20px;
    max-width: 900px;
    margin: 0 auto;
}

/* Main Title */
#pdf_data .pdf-main-title {    
    font-size: 26px;
    color: #6bc14b;
    text-align: center;
    margin: 0 0 30px 0;
    padding-bottom: 10px;
    border-bottom: 1px solid #6BC14B;
    font-weight: 500;
}

/* Section Titles */
#pdf_data .section-title {
    font-size: 18px;
    color: #000;
    border-bottom: 1px solid #6BC14B;
    padding-bottom: 8px;
    margin: 25px 0 15px 0;
    font-weight: 500;
}

/* Tables */
#pdf_data .table {
    width: 100%;
    margin-bottom: 25px;
    border-collapse: collapse;
    font-family: Helvetica;
}

#pdf_data .table th {
    font-weight: 600;
    font-size: 16px;
    text-align: left;
    padding: 12px 8px;
    border-bottom: 2px solid #6BC14B;
    color: #26459E;
    background-color: #f8f9fa;
    font-family: Helvetica;
    
}

#pdf_data .table td {
    padding: 10px 9px;
    font-size: 15px;
    border-bottom: 1px solid #e9ecef;
     font-family: Helvetica;
}

/* Value Cells */
#pdf_data .value-cell {
    font-family: Helvetica;
    font-weight: 500;
    color: #000;
}

/* Highlight Values */
#pdf_data .highlight-value {
    font-family: Helvetica;
    color: #6BC14B;
    font-weight: 600;
    font-size: 16px;
}

/* Savings Sections */
#pdf_data .savings-section {
    margin: 25px 0;
    padding: 15px;
    background-color: #f8f9fa;
    border-left: 3px solid #6BC14B;
}

/* Two-column layout for comparison tables */
#pdf_data .comparison-table {
    display: flex;
    justify-content: space-between;
    margin-bottom: 25px;
}

#pdf_data .comparison-col {
    width: 48%;
}

/* Disclaimer */
#pdf_data .disclaimer {
    margin-top: 35px;
    padding: 15px;
    background-color: #f8f9fa;
    border-left: 4px solid #6c757d;
    border-radius: 0 4px 4px 0;
    font-size: 14px;
}

#pdf_data .disclaimer h3 {
    color: #495057;
    font-size: 16px;
    margin-top: 0;
}
/* ==== QR code promo section ===================================================================================== */
 .qr-promo-container {
        margin: 10px 0 20px 0;
        padding: 8px;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        border-radius: 8px;
        box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        width: fit-content;
        max-width: 200px;
    }
    
    .qr-promo-content {
        text-align: center;
        padding: 5px;
    }
    
    .qr-title {
        font-size: 1rem;
        color: #2c3e50;
        margin: 5px 0;
        font-weight: 600;
    }
    
    .qr-subtitle {
        font-size: 0.8rem;
        color: #7f8c8d;
        margin-bottom: 8px;
    }
    
    .qr-image-container {
        padding: 5px;
        background: white;
        border-radius: 5px;
        display: inline-block;
    }
    
    .qr-image {
        width: 100px;
        height: 100px;
        object-fit: contain;
    }
    
    /* Hide on mobile devices */
    @media (max-width: 768px) {
        .qr-promo-container {
            display: none;
        }
    }
     .disclaimer {
        margin-top: 2rem;
        padding: 1.5rem;
        background-color: #f8f9fa;
        border-left: 4px solid #6c757d;
        border-radius: 0 4px 4px 0;
        font-size: 0.9rem;
        line-height: 1.5;
      }

      .disclaimer h3 {
        margin-top: 0;
        margin-bottom: 0.75rem;
        color: #495057;
        font-size: 1.1rem;
        font-weight: 600;
      }

      .disclaimer p {
        margin: 0;
        color: #6c757d;
      }

      @media (max-width: 768px) {
        .disclaimer {
          padding: 1rem;
          font-size: 0.85rem;
        }
      }
      .scenario-tabs-container {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-bottom: 15px;
}
.scenario-tabs-container .tab {
    padding: 8px 15px;
    background: #f0f0f0;
    border: 1px solid #ddd;
    border-radius: 4px;
    cursor: pointer;
}
.scenario-tabs-container .tab.active {
    background: #6BC14B;
    color: white;
    border-color: #6BC14B;
}
#compareWrap {
    margin-top: 20px;
    display: none;
}
/* Add to the style section */
#hm2_cl .apr-field {
    transition: all 0.3s ease;
}
#hm2_cl .toggle-apr {
    color: #6BC14B;
    text-decoration: none;
    font-size: 0.9em;
}
#hm2_cl .toggle-apr:hover {
    text-decoration: underline;
}

/* Add tooltip styling */
#hm2_cl .rs-sub-title-sp[title] {
    cursor: help;
    border-bottom: 1px dotted #6BC14B;
}

/* Ensure consistent spacing */
#hm2_cl .foorter-rs-sec {
    margin: 20px 0;
}

/* Responsive adjustments */
@media (max-width: 768px) {
    #hm2_cl .rs-sec {
        margin-bottom: 15px;
    }
}
/* newlyt added 29 july */

#hm2_cl .tooltip-icon {
    display: inline-block;
    width: 15px;
    height: 15px;
    background-color: #666565;
    color: white;
    border-radius: 90%;
    text-align: center;
    font-size: 12px;
    line-height: 10px;
    margin-left: 5px;
    cursor: help;
    position: relative;
}

#hm2_cl .tooltip-text {
    visibility: hidden;
    width: 200px;
    background-color: #333;
    color: #fff;
    text-align: center;
    border-radius: 6px;
    padding: 8px;
    position: absolute;
    z-index: 1;
    bottom: 125%;
    left: 50%;
    transform: translateX(-50%);
    opacity: 0;
    transition: opacity 0.3s;
}

#hm2_cl .tooltip-icon:hover .tooltip-text {
    visibility: visible;
    opacity: 1;
}

      /* ============================================= */

      /* Modal styles */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        backdrop-filter: blur(4px);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.3s ease;
      }

      .modal-overlay.active {
        opacity: 1;
        visibility: visible;
      }

      .modal-container {
        background: white;
        border-radius: 16px;
        width: 90%;
        max-width: 900px;
        max-height: 90vh;
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        transform: scale(0.9) translateY(20px);
        transition: all 0.3s ease;
        overflow: hidden;
      }

      .modal-overlay.active .modal-container {
        transform: scale(1) translateY(0);
      }

      .modal-header {
        padding: 20px 24px;
        border-bottom: 1px solid #e5e7eb;
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: #f9fafb;
      }

      .modal-title {
        font-size: 18px;
        font-weight: 600;
        color: #374151;
      }

      .close-button {
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: #6b7280;
        padding: 4px;
        border-radius: 8px;
        transition: all 0.2s ease;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .close-button:hover {
        background: #e5e7eb;
        color: #374151;
      }

      .tab-navigation {
        padding: 0 24px;
        background: #f9fafb;
        display: flex;
        gap: 8px;
        border-bottom: 1px solid #e5e7eb;
      }

      .tab-button {
        background: none;
        border: none;
        padding: 12px 16px;
        font-size: 14px;
        font-weight: 500;
        cursor: pointer;
        border-radius: 8px 8px 0 0;
        transition: all 0.2s ease;
        color: #6b7280;
      }

      .tab-button.active {
        background: #3b82f6;
        color: white;
      }

      .tab-button:not(.active):hover {
        background: #e5e7eb;
        color: #374151;
      }

      .modal-body {
        padding: 24px;
        max-height: 60vh;
        overflow-y: auto;
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
      }

      .code-container {
        background: #1f2937;
        border-radius: 8px;
        padding: 30px;
        margin-top: 12px;
        position: relative;
      }

      .code-block {
        color: #e5e7eb;
        font-family: "Monaco", "Menlo", "Ubuntu Mono", monospace;
        font-size: 13px;
        line-height: 1.6;
        white-space: pre-wrap;
        word-break: break-all;
      }

      .copy-button {
        position: absolute;
        top: 12px;
        right: 12px;
        background: #3b82f6;
        color: white;
        border: none;
        padding: 8px 14px;
        border-radius: 6px;
        font-size: 12px;
        font-weight: 500;
        cursor: pointer;
        transition: all 0.2s ease;
      }

      .copy-button:hover {
        background: #2563eb;
      }

      .copy-button.copied {
        background: #059669;
      }

      .description {
        color: #6b7280;
        font-size: 14px;
        margin-bottom: 16px;
        line-height: 1.5;
      }

      @media (max-width: 768px) {
        .modal-container {
          width: 95%;
          margin: 20px;
        }

        .modal-header,
        .modal-body {
          padding: 16px;
        }

        .tab-navigation {
          padding: 0 16px;
        }
      }

      /* Embed button styles */
      .embed-button {
        position: absolute;
        top: 70px;
        right: 50px;
        background: linear-gradient(135deg, #adade2, #41335e);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(79, 70, 229, 0.3);
        z-index: 10;
      }

      .embed-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(79, 70, 229, 0.4);
      }
       /* 📱 Mobile screens */
  @media (max-width: 768px) {
    .embed-button {
      position: relative;
      left: 43%; /* Center horizontally */
      transform: translateX(-7%);
      top: -10px; /* Adjust if needed */
      font-size: 12px; /* Slightly smaller text */
      padding: 10px 10px;
      margin-bottom: 25px;
    }
  }
 
</style>
<div id="hm2_cl">
    <div class="container cl-wrapper">
       
       
        <div class="row">
            
            
            <div class="col-md-12 cl-left-div">
                
                    <div class="qr-promo-container">
          <div class="qr-promo-content">
            <h2 class="qr-title">View on mobile</h2>
            <!-- <p class="qr-subtitle">Scan the QR code below</p> -->
            <div class="qr-image-container">
              <img
                src="https://res.cloudinary.com/dmdaa1heq/image/upload/v1749655873/Refinance_Comparison_Tool_qo7z43.png"
                alt="Scan QR Code"
                class="qr-image"
              />
            </div>
          </div>
        </div>

    <!-- now the modal popup ===================================================-->
      <!-- Embed Button -->
      <button class="embed-button" id="embedButton">
        <i class="fas fa-code mr-2"></i>Add to Website
      </button>

      <!-- Modal -->
      <div class="modal-overlay" id="modalOverlay">
        <div class="modal-container">
          <div class="modal-header">
            <h2 class="modal-title">Add to Website</h2>
            <button class="close-button" id="closeModalBtn">&times;</button>
          </div>

          <div class="tab-navigation">
            <button class="tab-button active" data-tab="via-code">
              Via Code
            </button>
            <!-- <button class="tab-button" data-tab="via-gtm">Via GTM</button> -->
          </div>

          <div class="modal-body">
            <div class="tab-content active" id="via-code">
              <p class="description">
                Copy this code to embed the calculator on your website
              </p>
              <div class="code-container">
                <button class="copy-button" id="copyBtn">Copy</button>               

                <pre class="code-block" id="codeBlock">
                <!-- &lt;iframe src="https://calculators.konnectd.io/Refinance_Comparison_Tool.html?location=LOCATION_ID_PLACEHOLDER" width="100%" height="800" frameborder="0" style="border: none;"&gt;&lt;/iframe&gt; -->
             https://calculators.konnectd.io/VA_Bonus_Entitlement_Code.html?location=LOCATION_ID_PLACEHOLDER
            </pre>
              </div>
            </div>

            <div class="tab-content" id="via-gtm">
              <p class="description">
                Add this code through Google Tag Manager
              </p>
              <div class="code-container">
                <button class="copy-button" id="copyBtnGTM">Copy</button>
                <pre class="code-block" id="codeBlockGTM">
                  &lt;script&gt;
                  // Google Tag Manager code for embedding calculator
                  (function() {
                    var iframe = document.createElement('iframe');
                    iframe.src = 'https://calculators.konnectd.io/Refinance_Comparison_Tool.html';
                    iframe.width = '100%';
                    iframe.height = '800';
                    iframe.style.border = 'none';
                    document.getElementById('calculator-container').appendChild(iframe);
                  })();
                  &lt;/script&gt;</pre
                >
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- end modal popup =========================================================== -->

                <p class="text-center">                    
                    
                    <img class="top-logo" src="https://msgsndr-private.storage.googleapis.com/companyPhotos/2d9246fe-8a1e-4c40-87ef-576ce1f5ec7f.png" alt="" srcset="">
                   
                    
                </p>

                <div id="scenarioTabs" class="scenario-tabs-container" style="margin-bottom: 20px;">
    <button class="tab active" data-id="scenario1">Scenario 1</button>
    <button id="addTab">+ Add Scenario</button>
</div>
                
                <div class="row">
                    <div class="col-md-6">
                        <h3 class="sec-top-title">Original Loan</h3>
                        <div class="row">
                            <div class="col-md-12">
                                <label for="hm2_in_1">Original loan amount</label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">$</span>
                                    </div>
                                    <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_1" value="">
                                </div>
                            </div>
                            <div class="col-md-12">
                                <label for="hm2_in_1">Original Term (years)</label>
                                <div class="input-group">
                                    <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_2" value="">
                                </div>
                            </div>
                            <div class="col-md-12">
                                <label for="hm2_in_1">Current Rate</label>
                                <div class="input-group">
                                    <input type="text" class="form-control hm2_cl-pr hm2_cl-input" id="hm2_in_3" value="">
                                    <div class="input-group-append">
                                        <span class="input-group-text">%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <h3 class="sec-top-title">New Loan</h3>
                        <div class="row">
                            <div class="col-md-12">
                                <label for="hm2_in_1">New loan amount</label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">$</span>
                                    </div>
                                    <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_4" value="">
                                </div>
                            </div>
                            <div class="col-md-12">
                                <label for="hm2_in_1">New Term (years)</label>
                                <div class="input-group">
                                    <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_5" value="">
                                </div>
                            </div>
                            <div class="col-md-12">
                                <label for="hm2_in_1">New Rate</label>
                                <div class="input-group">
                                    <input type="text" class="form-control hm2_cl-pr hm2_cl-input" id="hm2_in_6" value="">
                                    <div class="input-group-append">
                                        <span class="input-group-text">%</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="row">
                            <div class="col-md-3">
                                <label for="hm2_in_1">Value of home</label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">$</span>
                                    </div>
                                    <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_7" value="">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label for="hm2_in_1">Taxes</label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">$</span>
                                    </div>
                                    <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_8" value="">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label for="hm2_in_1">Insurance</label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">$</span>
                                    </div>
                                    <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_9" value="">
                                </div>
                            </div>
                            <div class="col-md-3">
                                <label for="hm2_in_1">PMI</label>
                                <div class="input-group">
                                    <div class="input-group-prepend">
                                        <span class="input-group-text">$</span>
                                    </div>
                                    <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_10" value="">
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- newly added this to the New Loan section (around line 370) ==================-->
            <div class="col-md-12">
                <div class="row">
                    <div class="col-md-4">
                        <label for="hm2_in_11">Closing Costs</label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">$</span>
                            </div>
                            <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_11" value="5000">
                        </div>
                    </div>
                    <div class="col-md-4">
                        <label for="hm2_in_12">Lender Credit</label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">$</span>
                            </div>
                            <input type="text" class="form-control hm2_cl-curr hm2_cl-input" id="hm2_in_12" value="0">
                        </div>
                    </div>
                    <!-- <div class="col-md-4">
                        <label for="hm2_in_13">Recoup Time</label>
                        <div class="input-group">
                            <input type="text" class="form-control" id="hm2_in_13" value="" readonly>
                            <div class="input-group-append">
                                <span class="input-group-text">months</span>
                            </div>
                        </div>
                    </div> -->
                </div>
            </div>
            <!-- newly addes =================================================================== -->

                
                    <div class="col-md-12 middle-rs-sec">
                    <br>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="rs-sec">
                                <div class="rs-sp-vl-sec text-center">
                                    <h4 class="rs-sub-title-sp" style="color: #26459E;">Current Payment</h4>
                                    <h2 class="rs-sp-value" id="hm2_rs_1">$0.00</h2>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="rs-sec">
                                <div class="rs-sp-vl-sec text-center">
                                    <h4 class="rs-sub-title-sp" style="color: #26459E;">New Payment</h4>
                                    <h2 class="rs-sp-value" id="hm2_rs_2">$0.00</h2>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12"><br></div>
                        <div class="col-md-6">
                            <div class="rs-sec">
                                <div class="rs-sp-vl-sec text-center">
                                    <h4 class="rs-sub-title-sp" style="color: #26459E;">Total Current Outflow</h4>
                                    <h2 class="rs-sp-value" id="hm2_rs_3">$0.00</h2>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="rs-sec">
                                <div class="rs-sp-vl-sec text-center">
                                    <h4 class="rs-sub-title-sp" style="color: #26459E;">New Outflow</h4>
                                    <h2 class="rs-sp-value" id="hm2_rs_4">$0.00</h2>
                                </div>
                            </div>
                        </div>
                    </div>
                    </div>
                    <div class="col-md-12 new-loan-sec">
                        <h3 class="new-loan-sec-title">New Loan:</h3>
                        <div style="overflow-x: auto;">
                            <table class="sp-table" id="debts_loan_tb">
                                <thead>
                                    <tr>
                                        <th class="sp-txt-cl">Total Debts</th>
                                        <th class="sp-txt-cl">Current</th>
                                        <th class="sp-txt-cl">Proposed</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Minimum Payments (without Mortgage)</td>
                                        <td id="nl_rs_1">$0.00</td>
                                        <td id="nl_rs_2">$0.00</td>
                                    </tr>
                                    <tr>
                                        <td>Mortgage Balance</td>
                                        <td id="nl_rs_3">$0.00</td>
                                        <td id="nl_rs_4">$0.00</td>
                                    </tr>
                                    <tr>
                                        <td>Time Left on Current Loan</td>
                                        <td id="nl_rs_5">$0.00</td>
                                        <td id="nl_rs_6">$0.00</td>
                                    </tr>
                                    <tr>
                                        <td>Taxes</td>
                                        <td id="nl_rs_7">$0.00</td>
                                        <td id="nl_rs_8">$0.00</td>
                                    </tr>
                                    <tr>
                                        <td>Insurance</td>
                                        <td id="nl_rs_9">$0.00</td>
                                        <td id="nl_rs_10">$0.00</td>
                                    </tr>
                                    <tr>
                                        <td>PMI</td>
                                        <td id="nl_rs_11">$0.00</td>
                                        <td id="nl_rs_12">$0.00</td>
                                    </tr>
                                    <tr>
                                        <td style="border-bottom: 1px solid #6BC14B;">Rate</td>
                                        <td  id="nl_rs_13"style="border-bottom: 1px solid #6BC14B;">$0.00</td>
                                        <td  id="nl_rs_14"style="border-bottom: 1px solid #6BC14B;">$0.00</td>
                                    </tr>
                                    <tfoot>
                                        <tr>
                                            <td class="sp-txt-cl">TOTAL Payments</td>
                                            <td class="sp-txt-cl" id="nl_rs_15">$0.00</td>
                                            <td class="sp-txt-cl" id="nl_rs_16">$0.00</td>
                                        </tr>
                                    </tfoot>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="col-md-12">
                        <div class="rs-saving-sec">
                            <div class="rs-saving-title">
                                Savings:
                            </div>
                            <div class="rs-saving-vl" id="sv_rs_1">
                                $0.00
                            </div>
                        </div>
                    </div>

                        <div class="col-md-12 all-debts-sec">
                        <h3 class="all-debts-sec-title">All Debts</h3>
                        <div style="overflow-x: auto;">
                            <table class="table" style="min-width: 430px;">
                                <thead>
                                    <tr>
                                        <th>Lender</th>
                                        <th>Payment</th>
                                        <th>Balance</th>
                                        <th style="min-width: 85px;">Paid at close?</th>
                                    </tr>
                                </thead>
                                <tbody id="all_debts_sec">
                                    <tr class="debts-row">
                                        <td>
                                            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="">
                                        </td>
                                        <td>
                                            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="">
                                        </td>
                                        <td>
                                            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="">
                                        </td>
                                        <td>
                                            <select name="" class="tb-form-control debts-in hm2_cl-input">
                                                <option data-value="">--Select--</option>
                                                <option data-value="Yes" selected>Yes</option>
                                                <option data-value="No">No</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="debts-row">
                                        <td>
                                            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="">
                                        </td>
                                        <td>
                                            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="">
                                        </td>
                                        <td>
                                            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="">
                                        </td>
                                        <td>
                                            <select name="" class="tb-form-control debts-in hm2_cl-input" id="">
                                                <option data-value="">--Select--</option>
                                                <option data-value="Yes" selected>Yes</option>
                                                <option data-value="No">No</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="debts-row">
                                        <td>
                                            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="">
                                        </td>
                                        <td>
                                            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="">
                                        </td>
                                        <td>
                                            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="">
                                        </td>
                                        <td>
                                            <select name="" class="tb-form-control debts-in hm2_cl-input" id="">
                                                <option data-value="">--Select--</option>
                                                <option data-value="Yes" selected>Yes</option>
                                                <option data-value="No">No</option>
                                            </select>
                                        </td>
                                    </tr>
                                    <tr class="debts-row">
                                        <td>
                                            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="">
                                        </td>
                                        <td>
                                            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="">
                                        </td>
                                        <td>
                                            <input type="text" class="tb-form-control debts-in hm2_cl-input" value="">
                                        </td>
                                        <td>
                                            <select name="" class="tb-form-control debts-in hm2_cl-input" id="">
                                                <option data-value="">--Select--</option>
                                                <option data-value="Yes" selected>Yes</option>
                                                <option data-value="No">No</option>
                                            </select>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <button class="btn btn-primary" id="add_debts_btn" style="margin-top: 25px;">+ Add debt</button>
                    </div>
                    <div class="col-md-12 debts-paid-sec">
                        <h3 class="debts-paid-sec-title"> Debts to Be Paid</h3>
                        <div style="overflow-x: auto;">
                            <table class="sp-table" id="debts_paid_tb">
                                <thead>
                                    <tr>
                                        <th class="sp-txt-cl">Account Name</th>
                                        <th class="sp-txt-cl">Payment</th>
                                        <th class="sp-txt-cl">Balance</th>
                                    </tr>
                                </thead>
                                <tbody id="debts_paid_sec"></tbody>
                                <tfoot style="border-top: 1px solid #6BC14B;">
                                    <tr>
                                        <td class="sp-txt-cl">TOTAL</td>
                                        <td class="sp-txt-cl" id="debts_paid_rs_1">$0.00</td>
                                        <td class="sp-txt-cl" id="debts_paid_rs_2">$0.00</td>
                                    </tr>
                                </tfoot>
                            </table>
                        </div>
                    </div>
                    <div class="col-md-12 middle-txt-sec">
                        <p class="middle-txt">Savings are based on the difference between your current monthly payments and the proposed loan payment</p>
                    </div>
                    <div class="col-md-12 foorter-rs-sec">
                        <div class="row">
                            <div class="col-md-3">
                                <div class="rs-sec">
                                    <div class="rs-sp-vl-sec text-center">
                                        <h4 class="rs-sub-title-sp" style="color: #26459E;">Monthly Savings</h4>
                                        <h2 class="rs-sp-value" id="hm2_rs_5">$0.00</h2>
                                    </div>
                                </div>
                            </div>
                            <!-- new update to remove ==================================== -->
                             <div class="col-md-3">
                                <div class="rs-sec">
                                    <div class="rs-sp-vl-sec text-center">
                                        <h4 class="rs-sub-title-sp" style="color: #26459E;">Recoup Time</h4>
                                        <h2 class="rs-sp-value" id="hm2_rs_recoup">0 months</h2>
                                    </div>
                                </div>
                            </div>
                        
                            <!-- end update ================================ -->
                            <div class="col-md-3">
                                <div class="rs-sec">
                                    <div class="rs-sp-vl-sec text-center">
                                        <h4 class="rs-sub-title-sp" style="color: #26459E;">Yearly Savings</h4>
                                        <h2 class="rs-sp-value" id="hm2_rs_6">$0.00</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="rs-sec">
                                    <div class="rs-sp-vl-sec text-center">
                                        <h4 class="rs-sub-title-sp" style="color: #26459E;">5 Year Savings</h4>
                                        <h2 class="rs-sp-value" id="hm2_rs_7">$0.00</h2>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="rs-sec">
                                    <div class="rs-sp-vl-sec text-center">
                                        <h4 class="rs-sub-title-sp" style="color: #26459E;">Life of Loan Savings</h4>
                                        <h2 class="rs-sp-value" id="hm2_rs_8">$0.00</h2>
                                    </div>
                                </div>
                            </div>
                             <div class="col-md-3">
                                <div class="rs-sec">
                                    <div class="rs-sp-vl-sec text-center">
                                        <h4 class="rs-sub-title-sp" style="color: #26459E;">
                                            Loan Paid Off In
                                            <span class="tooltip-icon">
                                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <circle cx="12" cy="12" r="10"></circle>
                                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                                        <line x1="12" y1="17" x2="12" y2="17"></line>
                                    </svg>
                                    <span class="tooltip-text">Based on your current payment schedule</span>
                                </span>
                                        </h4>
                                        <h2 class="rs-sp-value" id="hm2_rs_9">0 Years</h2>
                                    </div>
                                </div>
                            </div>
                             <div class="col-md-6">
                                <div class="rs-sec">
                                    <div class="rs-sp-vl-sec text-center">
                                        <h4 class="rs-sub-title-sp" style="color: #26459E;">Life of Loan Interest Savings</h4>
                                        <h2 class="rs-sp-value" id="hm2_rs_interest_savings">$0</h2>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    <div class="col-md-12 foorter-rs-sec-1">
                        <div class="row">
                          
                           
                                
                            <!-- <div class="col-md-6">
                                <div class="rs-sec">
                                    <div class="rs-sp-vl-sec text-center">
                                        <h4 class="rs-sub-title-sp" style="color: #26459E;">Cash Back at Closing</h4>
                                        <h2 class="rs-sp-value" id="hm2_rs_10">$0.00</h2>
                                    </div>
                                </div>
                            </div> -->
                        </div>
                    </div>
                    <div class="col-md-12"><br/></div>
                    <!-- new update ======================================================= -->
                    <!-- <div class="col-md-6">
                        <label for="">APR:</label>
                        <div class="input-group">
                            <input type="text" class="form-control hm2_cl-pr hm2_cl-input" id="in_apr" value="">
                            <div class="input-group-append">
                                <span class="input-group-text">%</span>
                            </div>
                        </div>
                    </div> -->

                    <!-- <div class="col-md-6">
                        <div class="form-group">
                            <label for="in_apr" style="display:inline-block;">
                                APR <small>(for PDF only)</small>
                                <a href="#" class="toggle-apr" style="margin-left:5px;">[show]</a>
                            </label>
                            <div class="input-group apr-field" style="display:none;">
                                <input type="text" class="form-control hm2_cl-pr hm2_cl-input" id="in_apr" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                        </div>
                    </div> -->
                    <!-- Replace the toggle version with this: -->
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="in_apr">
                                APR <small>(For PDF only)</small>
                            </label>
                            <div class="input-group">
                                <input type="text" class="form-control hm2_cl-pr hm2_cl-input" id="in_apr" value="">
                                <div class="input-group-append">
                                    <span class="input-group-text">%</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end here ======================================================= -->
                    <div class="col-md-6">
                        <div class="form-group">
                            <label for="">&nbsp;</label>
                            <button type="button" id="btn_download" class="btn btn-primary" style="width: 100%;">⇓ Download PDF</button>
                        </div>
                    </div>

                </div>
            </div>
            
        </div>
                    <div id="compareWrap" style="margin-top: 20px; display: none;">
    <h3>Scenario Comparison</h3>
    <table class="sp-table">
        <thead>
            <tr>
                <th>Scenario</th>
                <th>Term</th>
                <th>Rate</th>
                <th>Payment</th>
                <th>Monthly Savings</th>
                <th>Life Savings</th>
            </tr>
        </thead>
        <tbody id="compareBody"></tbody>
    </table>
</div>
      

        <div class="disclaimer">
                <h3>Disclaimer</h3>
                <p>
                All calculations are estimates for informational use only and based on
                data entered by the user. Results do not reflect guaranteed terms,
                rates, or outcomes. Additional costs (e.g. PMI, FHA, VA, USDA fees)
                may apply depending on loan structure. Provided by Konnectd as a
                reference tool only.
                </p>
            </div>

  
            
    </div>

</div>

<div id="pdf_section">
    
    <div id="pdf_data">
        <!-- <p class="text-center">
            <img class="top-logo" id="my_logo" src="https://msgsndr-private.storage.googleapis.com/companyPhotos/2d9246fe-8a1e-4c40-87ef-576ce1f5ec7f.png" alt="" srcset="">
        </p> -->
         <div style="text-align: center; margin-top: 0px; margin-bottom: 10px;">
    <h1 class="pdf-main-title"
     style="
        font-family: 'Helvetica';        
        font-size: 28px;
        color: #2c3e50;
        letter-spacing: 0px;
        font-weight: 700;
        border-bottom: 2px solid #2c3e50;
        display: inline-block;
        padding-bottom: 7px;
        margin: 3;
    ">
        Refinance Comparison
    </h1>
</div>
      
        <div id="loan_sec">
            <table class="table">
                <thead>
                    <tr>
                        <th colspan="2" >Original Loan</th>
                        <th></th>
                        <th></th>
                        <th>New Loan</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="value-cell">Original loan amount</td>
                        <td  class="highlight-value" id="pdf_in_1">$0.00</td>
                        <td></td>
                        <td class="value-cell">New loan amount</td>
                        <td class="highlight-value" id="pdf_in_4">$0.00</td>
                    </tr>
                    <tr>
                        <td class="value-cell" >Original Term (years)</td>
                        <td class="highlight-value" id="pdf_in_2">0</td>
                        <td></td>
                        <td class="value-cell" >New Term (years)</td>
                        <td class="highlight-value" id="pdf_in_5">0</td>
                    </tr>
                    <tr>
                        <td class="value-cell">Current Rate</td>
                        <td class="highlight-value" id="pdf_in_3">0.000%</td>
                        <td></td>
                        <td class="value-cell">New Rate</td>
                        <td class="highlight-value" id="pdf_in_6">0.000%</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div id="value_sec">
            <table class="table">
                <thead>
                    <tr>
                        <th style="width: 20%;">Value of home</th>
                        <th style="width: 20%;">Taxes</th>
                        <th style="width: 20%;">Insurance</th>
                        <th style="width: 15%;">PMI</th>
                        <th style="width: 15%;">APR</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td id="pdf_in_7">$0.00</td>
                        <td id="pdf_in_8">$0.00</td>
                        <td id="pdf_in_9">$0.00</td>
                        <td id="pdf_in_10">$0.00</td>
                        <td id="pdf_in_apr">0.00%</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div id="value_sec">
            <table class="table">
                <thead>
                    <tr>
                        <th class="pdf-rs-title">Current Payment</th>
                        <th class="pdf-rs-title">New Payment</th>
                        <th class="pdf-rs-title">Total Current Outflow</th>
                        <th class="pdf-rs-title">New Outflow</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td class="highlight-value" id="pdf_rs_1">$0.00</td>
                        <td class="pdf-rs-vl highlight-value" id="pdf_rs_2">$0.00</td>
                        <td class="pdf-rs-vl highlight-value" id="pdf_rs_3">$0.00</td>
                        <td class="pdf-rs-vl highlight-value" id="pdf_rs_4">$0.00</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div id="comparison-col">
            <table class="table">
                <thead>
                    <tr>
                        <th colspan="2">New Loan</th>
                    </tr>
                </thead>
            </table>
            <table class="table" id="pdf_table_1">
                
            </table>
        </div>
        <table class="table" style="margin-bottom: 10px;">
            <thead>
                <tr>
                    <th class="pdf-rs-title" style="text-align: left !important;">Savings</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td class="pdf-rs-vl highlight-value" id="pdf_sv_rs_1" style="text-align: left !important;">$0.00</td>
                </tr>
            </tbody>
        </table>
        <div id="debts_paid_sec">
            <table class="table">
                <thead>
                    <tr>
                        <th>Debts to be paid</th>
                    </tr>
                </thead>
            </table>
            <table class="table" id="pdf_table_2">
            </table>
        </div>
        <div id="pdf_txt_sec">
            <p style="font-size: 13px;">Savings are based on the difference between your current monthly payments and the proposed loan payment</p>
        </div>
        <div id="footer_rs_sec">
            <table class="table">
                <thead>
                    <tr>
                        <th style="width: 24%;" class="pdf-rs-title">Monthly Savings</th>
                        <th style="width: 24%;" class="pdf-rs-title">Yearly Savings</th>
                        <th style="width: 24%;" class="pdf-rs-title">5 Year Savings</th>
                        <th style="width: 30%;" class="pdf-rs-title">Life of Loan Savings</th>
                       
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td  class="pdf-rs-vl highlight-value" id="pdf_rs_5">$0.00</td>
                        <td class="pdf-rs-vl highlight-value" id="pdf_rs_6">$0.00</td>
                        <td class="pdf-rs-vl highlight-value" id="pdf_rs_7">$0.00</td>
                        <td class="pdf-rs-vl highlight-value" id="pdf_rs_8">$0.00</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <div id="bottom_footer_sec">
            <table class="table" style="margin-top: 70px; margin-bottom: 20px;">
                <thead>
                    <tr>
                        <th class="pdf-rs-title" style="width: 31%; ">Loan Paid Off In</th>
                        <!-- <th class="pdf-rs-title" style="width: 50%;">Cash Back at Closing</th> -->
                         <th class="pdf-rs-title" style="width: 31%;">Recoup Time</th>
                          <th class="pdf-rs-title" style="width: 40%;">Life of Loan Interest Savings</th>
                    </tr>
                    <!-- new update ======================================== -->
                    <!-- Add this to the PDF section around where other savings are displayed -->
                    <!-- <tr>
                        <td class="pdf-rs-title">Recoup Time</td>
                        <td class="pdf-rs-vl" id="pdf_rs_recoup">0 months</td>
                    </tr> -->
                    <!-- end update ============================ -->
                </thead>
                <tbody>
                    <tr>
                        <td class="pdf-rs-vl highlight-value" id="pdf_rs_9">$0.00</td>
                        <!-- <td class="pdf-rs-vl" id="pdf_rs_10">$0.00</td> -->
                           <td class="pdf-rs-vl highlight-value" id="pdf_rs_recoup">0 months</td>
                            <td class="pdf-rs-vl highlight-value" id="pdf_rs_interest_savings">$0</td>
                    </tr>
                </tbody>
            </table>
        </div>

         <div class="disclaimer">
                <h3>Disclaimer</h3>
                <p>
                All figures shown here are estimates for comparison only. Rates, APRs, payments, loan amounts, and points may change without notice and depend on credit approval, property eligibility, and program availability. Taxes and insurance are not included in the payment examples. This calculator is not an offer or commitment to lend.
                </p>
            </div>
    </div>

</div>
<script src="https://cdn.jsdelivr.net/npm/autonumeric@4.5.4"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.8.0/html2pdf.bundle.min.js"></script>
<script>
jQuery(document).ready(function($){
            // Modal functionality ------------------------------------------------------------------------
        //]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]

        const modal = document.getElementById("modalOverlay");
        const embedButton = document.getElementById("embedButton");
        const closeButton = document.getElementById("closeModalBtn");
        const tabButtons = document.querySelectorAll(".tab-button");
        const tabContents = document.querySelectorAll(".tab-content");
        const copyButtons = document.querySelectorAll(".copy-button");

        // Open modal
        embedButton.addEventListener("click", () => {
          modal.classList.add("active");
          document.body.style.overflow = "hidden";
        });

        // Close modal
        closeButton.addEventListener("click", () => {
          modal.classList.remove("active");
          document.body.style.overflow = "";
        });

        // Close modal when clicking outside
        modal.addEventListener("click", (e) => {
          if (e.target === modal) {
            modal.classList.remove("active");
            document.body.style.overflow = "";
          }
        });

        // Handle escape key
        document.addEventListener("keydown", (e) => {
          if (e.key === "Escape" && modal.classList.contains("active")) {
            modal.classList.remove("active");
            document.body.style.overflow = "";
          }
        });

        // Tab functionality
        tabButtons.forEach((button) => {
          button.addEventListener("click", () => {
            const tabId = button.dataset.tab;

            // Remove active class from all tabs and contents
            tabButtons.forEach((btn) => btn.classList.remove("active"));
            tabContents.forEach((content) =>
              content.classList.remove("active")
            );

            // Add active class to selected tab and content
            button.classList.add("active");
            document.getElementById(tabId).classList.add("active");
          });
        });

        // Copy functionality
        copyButtons.forEach((button) => {
          button.addEventListener("click", (e) => {
            const codeBlock = button.parentElement.querySelector(".code-block");
            const text = codeBlock.textContent;

            copyToClipboard(text, button);
          });
        });

        // Copy to clipboard function
        async function copyToClipboard(text, button) {
          try {
            await navigator.clipboard.writeText(text);

            // Visual feedback
            const originalText = button.textContent;
            button.textContent = "Copied!";
            button.classList.add("copied");

            setTimeout(() => {
              button.textContent = originalText;
              button.classList.remove("copied");
            }, 2000);
          } catch (err) {
            console.error("Failed to copy text: ", err);

            // Fallback for older browsers
            const textArea = document.createElement("textarea");
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            document.execCommand("copy");
            document.body.removeChild(textArea);

            button.textContent = "Copied!";
            button.classList.add("copied");
            setTimeout(() => {
              button.textContent = "Copy";
              button.classList.remove("copied");
            }, 2000);
          }
        }

        // end moda functionality =============================================================================

        // ]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]
    // Scenario management
    let scenarios = [];
    let activeScenarioId = null;
    
    // Number formatting
    const hm2_nft = Intl.NumberFormat("en-US", {
        minimumFractionDigits: 0,
        maximumFractionDigits: 0
    });
    const hm2_nftd = Intl.NumberFormat("en-US", {
        minimumFractionDigits: 0,
        maximumFractionDigits: 2
    });

    // AutoNumeric configuration
    const hm2_numOptionCurrency = {
        digitGroupSeparator        : ',',
        decimalCharacter           : '.',
        decimalCharacterAlternative: '.',
        currencySymbol             : '',
        currencySymbolPlacement    : AutoNumeric.options.currencySymbolPlacement.prefix,
        decimalPlaces              : 0
    };
    const hm2_numOptionPercent = {
        digitGroupSeparator        : ',',
        decimalCharacter           : '.',
        decimalCharacterAlternative: '.',
        currencySymbol             : '',
        currencySymbolPlacement    : AutoNumeric.options.currencySymbolPlacement.suffix,
        decimalPlaces              : 3,
        minimumValue               : 0,
        maximumValue               : 100
    };

    // Initialize AutoNumeric
    new AutoNumeric.multiple('.hm2_cl-curr', hm2_numOptionCurrency);
    new AutoNumeric.multiple('.hm2_cl-pr', hm2_numOptionPercent);
    
    // Initialize first scenario
    function initFirstScenario() {
        const scenario = {
            id: 'scenario1',
            label: 'Scenario 1',
            inputs: {
                origAmount: 0,
                origTerm: 30,
                currRate: 0,
                newAmount: 0,
                newTerm: 30,
                newRate: 0,
                homeValue: 0,
                taxes: 0,
                insurance: 0,
                pmi: 0,
                closingCosts: 5000,
                debts: []
            },
            outputs: {}
        };
        scenarios = [scenario];
        activeScenarioId = scenario.id;
        renderTabs();
        loadScenario(scenario);
    }
    
    // Render scenario tabs
   function renderTabs() {
    const $wrap = $('#scenarioTabs').empty();
    scenarios.forEach(s => {
        $wrap.append(`<button class="tab ${s.id===activeScenarioId?'active':''}"
                           data-id="${s.id}">${s.label}</button>`);
    });
    $wrap.append(`<button id="addTab" class="add-tab-btn">+ Add Scenario</button>`);
}
    // Load scenario data into form
// Update the loadScenario function to this:
function loadScenario(scenario) {
    const i = scenario.inputs;
    
    // Set values without triggering events
    $("#hm2_in_1").val(i.origAmount);
    $("#hm2_in_2").val(i.origTerm);
    $("#hm2_in_3").val(i.currRate);
    $("#hm2_in_4").val(i.newAmount);
    $("#hm2_in_5").val(i.newTerm);
    $("#hm2_in_6").val(i.newRate);
    $("#hm2_in_7").val(i.homeValue || 0);
    $("#hm2_in_8").val(i.taxes);
    $("#hm2_in_9").val(i.insurance);
    $("#hm2_in_10").val(i.pmi);
    
    // Handle debts
    $("#all_debts_sec").empty();
    i.debts.forEach(debt => {
        addDebtRow(debt);
    });
    
    // Update comparison table
    renderComparisonTable();
}

    // Save form data to current scenario
    function saveCurrentScenario() {
        const scenario = scenarios.find(s => s.id === activeScenarioId);
        if (!scenario) return;
        
        scenario.inputs = {
            origAmount: hm2_removeSign($("#hm2_in_1").val()),
            origTerm: hm2_removeSign($("#hm2_in_2").val()),
            currRate: hm2_removeSign($("#hm2_in_3").val()),
            newAmount: hm2_removeSign($("#hm2_in_4").val()),
            newTerm: hm2_removeSign($("#hm2_in_5").val()),
            newRate: hm2_removeSign($("#hm2_in_6").val()),
            homeValue: hm2_removeSign($("#hm2_in_7").val()),
            taxes: hm2_removeSign($("#hm2_in_8").val()),
            insurance: hm2_removeSign($("#hm2_in_9").val()),
            pmi: hm2_removeSign($("#hm2_in_10").val()),
            debts: getCurrentDebts()
        };
    }
    
    function getCurrentDebts() {
        const debts = [];
        $(".debts-row").each(function() {
            debts.push({
                lender: $(this).find("td:eq(0) .debts-in").val(),
                payment: hm2_removeSign($(this).find("td:eq(1) .debts-in").val()),
                balance: hm2_removeSign($(this).find("td:eq(2) .debts-in").val()),
                paid: $(this).find("td:eq(3) .debts-in").val()
            });
        });
        return debts;
    }
    
function addDebtRow(debt = {lender: '', payment: '', balance: '', paid: 'Yes'}) {
    const row = `<tr class="debts-row">
        <td><input type="text" class="tb-form-control debts-in" value="${debt.lender || ''}"></td>
        <td><input type="text" class="tb-form-control debts-in num-input" value="${debt.payment || ''}"></td>
        <td><input type="text" class="tb-form-control debts-in num-input" value="${debt.balance || ''}"></td>
        <td>
            <select class="tb-form-control debts-in">
                <option value="">--Select--</option>
                <option value="Yes" ${debt.paid === 'Yes' ? 'selected' : ''}>Yes</option>
                <option value="No" ${debt.paid === 'No' ? 'selected' : ''}>No</option>
            </select>
        </td>
    </tr>`;
    
    $("#all_debts_sec").append(row);
    
    // Initialize AutoNumeric only for numeric inputs
    new AutoNumeric.multiple('#all_debts_sec .debts-row:last-child .num-input', {
        digitGroupSeparator: ',',
        decimalCharacter: '.',
        decimalPlaces: 0
    });
}
function renderComparisonTable() {
    if (scenarios.length < 2) {
        $('#compareWrap').hide();
        return;
    }
    
    const rows = scenarios.map(s => {
        // Format numbers properly using your existing formatters
        const rateFormatted = (s.inputs.newRate * 100).toFixed(3);
        const paymentFormatted = hm2_nftd.format(s.outputs.newPayment || 0);
        const monthlySavingsFormatted = hm2_nftd.format(s.outputs.monthlySavings || 0);
        const lifeSavingsFormatted = hm2_nftd.format(s.outputs.lifeSavings || 0);
        
        return `
            <tr ${s.id === activeScenarioId ? 'class="active-scenario"' : ''}>
                <td>${s.label}</td>
                <td>${s.inputs.newTerm} yr</td>
                <td>${rateFormatted}%</td>
                <td>$${paymentFormatted}</td>
                <td>$${monthlySavingsFormatted}</td>
                <td>$${lifeSavingsFormatted}</td>
            </tr>`;
    }).join('');
    
    $('#compareBody').html(rows);
    $('#compareWrap').show();
}

    // Modified event handlers
    $(".hm2_cl-input").on("input", function(){
        saveCurrentScenario();
        hm2_calc();
    });
    
    $(document).on("input", ".debts-in", function(){
        saveCurrentScenario();
        hm2_calc();
    });

    $("#add_debts_btn").on("click", function() {
        addDebtRow();
        saveCurrentScenario();
        hm2_calc();
    });

    // Scenario tab events
$(document).on('click', '#scenarioTabs .tab:not(#addTab)', function() {
    const id = $(this).data('id');
    const scenario = scenarios.find(s => s.id === id);
    if (scenario) {
        activeScenarioId = id;
        renderTabs();
        loadScenario(scenario);
    }
});
$('#scenarioTabs').on('click', '#addTab', function(e) {
    e.preventDefault();
    const currentScenario = scenarios.find(s => s.id === activeScenarioId);
    if (!currentScenario) return;
    
    const newId = 'scenario-' + Date.now();
    const newScenario = {
        id: newId,
        label: 'Scenario ' + (scenarios.length + 1),
        inputs: JSON.parse(JSON.stringify(currentScenario.inputs)),
        outputs: {}
    };
    
    scenarios.push(newScenario);
    activeScenarioId = newId;
    renderTabs();
    loadScenario(newScenario);
});
    
// Update the addTab click handler to this:
$('#addTab').on('click', function() {
    const currentScenario = scenarios.find(s => s.id === activeScenarioId);
    if (!currentScenario) return;
    
    const newId = 'scenario' + Date.now(); // Use timestamp for unique ID
    const newScenario = {
        id: newId,
        label: 'Scenario ' + (scenarios.length + 1),
        inputs: JSON.parse(JSON.stringify(currentScenario.inputs)),
        outputs: {}
    };
    
    scenarios.push(newScenario);
    activeScenarioId = newId;
    renderTabs();
    loadScenario(newScenario);
});

    // Main calculation function
    function hm2_calc(){
        const scenario = scenarios.find(s => s.id === activeScenarioId);
        if (!scenario) return;
        
        hm2_in_1 =  hm2_removeSign($("#hm2_in_1").val());
        hm2_in_2 =  hm2_removeSign($("#hm2_in_2").val());
        hm2_in_3 =  hm2_removeSign($("#hm2_in_3").val()) / 100;
        hm2_in_4 =  hm2_removeSign($("#hm2_in_4").val());
        hm2_in_5 =  hm2_removeSign($("#hm2_in_5").val());
        hm2_in_6 =  hm2_removeSign($("#hm2_in_6").val()) / 100;
        hm2_in_7 =  hm2_removeSign($("#hm2_in_7").val());
        hm2_in_8 =  hm2_removeSign($("#hm2_in_8").val());
        hm2_in_9 =  hm2_removeSign($("#hm2_in_9").val());
        hm2_in_10 =  hm2_removeSign($("#hm2_in_10").val());

        //==============================================
        //  these new update variables
            hm2_in_11 = hm2_removeSign($("#hm2_in_11").val());
            hm2_in_12 = hm2_removeSign($("#hm2_in_12").val());
        //==============================================

        let debt_rows = "";
        let debt_total = 0;
        let debt_balance  = 0;
        let all_balance_total = 0;
        let no_total = 0;
        $(document).find(".debts-row").each(function(i, elm){
            let pr = $(elm);

            let lender = pr.find("td:eq(0) .debts-in").val();
            let payment = hm2_removeSign(pr.find("td:eq(1) .debts-in").val());
            let balance = hm2_removeSign(pr.find("td:eq(2) .debts-in").val());
            let paid = pr.find("td:eq(3) .debts-in").val();
            all_balance_total = all_balance_total + payment;
            if(paid == "Yes" && payment && balance){
                debt_total = debt_total + payment;
                debt_balance = debt_balance + balance;

                debt_rows = debt_rows + `
                    <tr>
                        <td>${lender}</td>
                        <td>$${hm2_nftd.format(payment)}</td>
                        <td>$${hm2_nftd.format(balance)}</td>
                    </tr>
                `;
            } else if(paid == "No"){
                no_total = no_total + payment;
            }
        });
        $("#debts_paid_sec").html(debt_rows);
        $("#debts_paid_rs_1").text("$" + hm2_nftd.format(debt_total));
        $("#debts_paid_rs_2").text("$" + hm2_nftd.format(debt_balance));

        let current_pi = PMT(hm2_in_3 / 12, hm2_in_2 * 12, (-1 * hm2_in_1));
        let propose_mortgage_bl = PMT(hm2_in_6 / 12, hm2_in_5 * 12, (-1 * hm2_in_4));

        let current_paymenent = current_pi + hm2_in_8 + hm2_in_9 + hm2_in_10;
        let proposed_pmi = 0;
        let new_payment = propose_mortgage_bl + hm2_in_8 + hm2_in_9 + proposed_pmi;
        
        let total_current_outflow =  all_balance_total + current_paymenent;
        let new_outflow = all_balance_total - debt_total + new_payment;
        let current_total_payment = all_balance_total + current_paymenent;
        let proposed_total_payment = no_total + new_payment;
        let total_savings = current_total_payment - proposed_total_payment;
        let yearly_savings = total_savings * 12;
        let five_year_savings = yearly_savings * 5;
        let life_loan_savings =  total_savings * (hm2_in_5 * 12);

        let new_paymnt = new_payment + debt_total;
        let total_new_payment = nper(hm2_in_3/12, (-1*new_paymnt), hm2_in_1);
        let year_remove_curr_payment = total_new_payment / 12;

        // new updated ===============================================
        // Add recoup time calculation
        let recoupMonths = 0;
        if (total_savings > 0) {
            recoupMonths = (hm2_in_11 - hm2_in_12) / total_savings;
        }
        recoupMonths = Math.round(recoupMonths * 100) / 100; // Round to 2 decimals

        //

        // Add these calculations:
        const remainingPayments = hm2_in_2 * 12; // Original term in months
        const currentTotalInterest = (current_pi * remainingPayments) - hm2_in_1;
        const refiTotalInterest = (propose_mortgage_bl * hm2_in_5 * 12) - hm2_in_4;
        const lifeInterestSavings = currentTotalInterest - refiTotalInterest;
        // =================================================

        // Store outputs in current scenario
        scenario.outputs = {
            currentPayment: current_paymenent,
            newPayment: new_payment,
            totalCurrentOutflow: total_current_outflow,
            newOutflow: new_outflow,
            monthlySavings: total_savings,
            yearlySavings: yearly_savings,
            fiveYearSavings: five_year_savings,
            lifeSavings: life_loan_savings,
            yearsRemoved: year_remove_curr_payment,
            // new update =======================================
            recoupMonths: recoupMonths,
            lifeInterestSavings: lifeInterestSavings
            //=======================================
        };

        // Update UI
        $("#sv_rs_1, #pdf_sv_rs_1").text("$" + hm2_nftd.format(total_savings));
        $("#hm2_rs_1, #pdf_rs_1").text("$" + hm2_nftd.format(current_paymenent));
        $("#hm2_rs_2, #pdf_rs_2").text("$" + hm2_nft.format(new_payment));
        $("#hm2_rs_3, #pdf_rs_3").text("$" + hm2_nftd.format(total_current_outflow));
        $("#hm2_rs_4, #pdf_rs_4").text("$" + hm2_nftd.format(new_outflow));
        $("#hm2_rs_5, #pdf_rs_5").text("$" + hm2_nftd.format(total_savings));
        $("#hm2_rs_6, #pdf_rs_6").text("$" + hm2_nftd.format(yearly_savings));
        $("#hm2_rs_7, #pdf_rs_7").text("$" + hm2_nftd.format(five_year_savings));
        $("#hm2_rs_8, #pdf_rs_8").text("$" + hm2_nftd.format(life_loan_savings));

        //===============================================================================
        $("#hm2_rs_9, #pdf_rs_9").text(hm2_nftd.format(year_remove_curr_payment) + " Years");
       // $("#hm2_rs_9, #pdf_rs_9").text(hm2_nft.format(year_remove_curr_payment));
       // Update UI
        $("#hm2_rs_interest_savings, #pdf_rs_interest_savings").text("$" + hm2_nft.format(lifeInterestSavings));

       //================================================================================

        $("#nl_rs_1").text("$" + hm2_nftd.format(all_balance_total));
        $("#nl_rs_2").text("$" + hm2_nftd.format(no_total));
        $("#nl_rs_3").text("$" + hm2_nftd.format(hm2_in_1));
        $("#nl_rs_4").text("$" + hm2_nftd.format(hm2_in_4));
        $("#nl_rs_5").text(hm2_nftd.format(hm2_in_2) + " Years");
        $("#nl_rs_6").text(hm2_nftd.format(hm2_in_5) + " Years");
        $("#nl_rs_7").text("$" + hm2_nftd.format(hm2_in_8));
        $("#nl_rs_8").text("$" + hm2_nftd.format(hm2_in_8));
        $("#nl_rs_9").text("$" + hm2_nftd.format(hm2_in_9));
        $("#nl_rs_10").text("$" + hm2_nftd.format(hm2_in_9));
        $("#nl_rs_11").text("$" + hm2_nftd.format(hm2_in_10));
        $("#nl_rs_12").text("$" + hm2_nftd.format(proposed_pmi));
        $("#nl_rs_13").text(hm2_nftd.format(hm2_in_3 * 100) + "%");
        $("#nl_rs_14").text(hm2_nftd.format(hm2_in_6 * 100) + "%");
        $("#nl_rs_15").text("$" + hm2_nftd.format(current_total_payment));
        $("#nl_rs_16").text("$" + hm2_nftd.format(proposed_total_payment));

        // new update =========================================
       // Update UI with recoup time
      //  $("#hm2_rs_recoup").val(recoupMonths);
         $("#hm2_rs_recoup").text(recoupMonths + " months");
        $("#pdf_rs_recoup").text(recoupMonths + " months");
        
        // Change "Years Removed" label and calculation
        $("#hm2_rs_9, #pdf_rs_9").text(hm2_nft.format(year_remove_curr_payment) + " Years");
        $(".rs-sub-title-sp:contains('Years Removed')").text("Loan Paid Off In:");

        //=========================================

        let table1 = $("#debts_loan_tb").html();
        let table2 = $("#debts_paid_tb").html();
        
        let in_apr = $("#in_apr").val();

        $("#pdf_table_1").html(table1);
        $("#pdf_table_2").html(table2);

        $("#pdf_in_1").text("$" + hm2_nftd.format(hm2_in_1));
        $("#pdf_in_2").text(hm2_in_2);
        $("#pdf_in_3").text(hm2_nftd.format(hm2_in_3*100) + "%");
        $("#pdf_in_4").text("$" + hm2_nftd.format(hm2_in_4));
        $("#pdf_in_5").text(hm2_in_5);
        $("#pdf_in_6").text(hm2_nftd.format(hm2_in_6*100) + "%");
        $("#pdf_in_7").text("$" + hm2_nftd.format(hm2_in_7));
        $("#pdf_in_8").text("$" + hm2_nftd.format(hm2_in_8));
        $("#pdf_in_9").text("$" + hm2_nftd.format(hm2_in_9));
        $("#pdf_in_10").text("$" + hm2_nftd.format(hm2_in_10));
        $("#pdf_in_apr").text(hm2_nftd.format(in_apr)+"%");

        // Update comparison table if multiple scenarios
       // if (scenarios.length > 1) {
            renderComparisonTable();
      //  }
    }

    function hm2_removeSign(vl){
        return Number(vl.replace(/,/g,''));
    }

    function PMT(rate, nperiod, pv, fv, type) {
        if (!fv) fv = 0;
        if (!type) type = 0;

        if (rate == 0) return -(pv + fv)/nperiod;

        var pvif = Math.pow(1 + rate, nperiod);
        var pmt = rate / (pvif - 1) * -(pv * pvif + fv);

        if (type == 1) {
            pmt /= (1 + rate);
        };

        return pmt;
    }

    function nper(rate, payment, present, future, type) {
        var type = (typeof type === 'undefined') ? 0 : type;
        var future = (typeof future === 'undefined') ? 0 : future;
        rate = eval(rate);

        var num = payment * (1 + rate * type) - future * rate;
        var den = (present * rate + payment * (1 + rate * type));
        return Math.log(num / den) / Math.log(1 + rate);
    }

    function toDataUrl(url, callback) {
        var xhr = new XMLHttpRequest();
        xhr.onload = function() {
            var reader = new FileReader();
            reader.onloadend = function() {
                callback(reader.result);
            }
            reader.readAsDataURL(xhr.response);
        };
        xhr.open('GET', url);
        xhr.responseType = 'blob';
        xhr.send();
    }

  //  let src = $("#my_logo").attr("src");

 //   toDataUrl(src, function(myBase64) {
 //       $("#my_logo").attr("src", myBase64);
  //  });

    $('#btn_download').on('click', function(){
        $(this).prop('disabled', true);
        $('#btn_download').text("Downloading....");
        genPDF();
        setTimeout(() => {
            $('#btn_download').prop('disabled', false);
            $('#btn_download').text("Download");
        }, 500);
    });
    

    /*  new add ===================================== */

        $(".toggle-apr").on("click", function(e) {
            e.preventDefault();
            $(this).text(function(i, text) {
                return text === "[show]" ? "[hide]" : "[show]";
            });
            $(".apr-field").toggle();
        });


   /* ====================================== */

    /*
    function genPDF(){
        var d = new Date();
        let date_time = d.getMonth() + 1+"_"+ d.getDate() + "_"+d.getFullYear()+"_"+d.getHours()+"_"+d.getMinutes()+"_"+d.getSeconds();
        var element = document.getElementById('pdf_data');
        html2pdf(element, {
            margin:       10,
            enableLinks:  true,
            filename:     'Loan_Calculator_'+date_time+".pdf",
            image: { type: 'png', quality: 100 },
            html2canvas: { 
                 useCORS: true,
                 logging: false,                 
                allowTaint: true,
                letterRendering: true,
                scale: 5,
            },
            jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
        });
    }
        */

    function genPDF(){
    var element = document.getElementById('pdf_data');
    html2pdf(element, {
        margin: 10,
        filename: 'Refinance_Comparison.pdf', // Simpler filename
        image: { type: 'jpeg', quality: 0.98 }, // Slightly compressed
        html2canvas: { 
            scale: 3, // Reduced from 5 (still HD)
            logging: false,
            useCORS: true
        },
        jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' }
    });
}

    // Initialize
    initFirstScenario();
});

      //making it secureeee
      // Disable right-click
      document.addEventListener("contextmenu", function (e) {
        e.preventDefault();
      });

      // Disable F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U, Ctrl+S, etc.
      document.onkeydown = function (e) {
        if (
          e.key === "F12" ||
          (e.ctrlKey &&
            e.shiftKey &&
            (e.key === "I" || e.key === "J" || e.key === "C")) ||
          (e.ctrlKey && (e.key === "U" || e.key === "S"))
        ) {
          e.preventDefault();
          return false;
        }
      };
      // securing end

</script>
<script>
  // Function to get URL parameters
  function getUrlParameter(name) {
    name = name.replace(/[\[\]]/g, "\\$&");
    const regex = new RegExp("[?&]" + name + "(=([^&#]*)|&|#|$)");
    const results = regex.exec(window.location.href);
    if (!results) return null;
    if (!results[2]) return "";
    return decodeURIComponent(results[2].replace(/\+/g, " "));
  }

  // Get location ID from URL
  const locationId = getUrlParameter("locationid");
</script>
<script>
  // Function to update embed code with actual location ID
  function updateEmbedCode() {
    if (locationId) {
      const codeBlock = document.getElementById('codeBlock');
      if (codeBlock) {
        const embedCode = `https://calculators.konnectd.io/Refinance_Comparison_Tool.html?location=${locationId}`;
        codeBlock.textContent = embedCode;
      }
    }
  }
  
  // Update embed code when page loads
  document.addEventListener('DOMContentLoaded', updateEmbedCode);
</script>

</html>
